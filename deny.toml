[advisories]
db-path = "~/.cargo/advisory-db"
db-urls = ["https://github.com/rustsec/advisory-db"]
# unmaintained: scope of packages to check (all/workspace/transitive/none)
# "vulnerability", "notice" keys removed in cargo-deny 0.16+
unmaintained = "workspace"
yanked = "warn"
ignore = [
    { id = "RUSTSEC-2025-0134", reason = "rustls-pemfile deprecated but not a vulnerability; upstream recommends rustls-pki-types which is already in use" },
]

[licenses]
# "version", "unlicensed", "copyleft" keys removed in cargo-deny 0.16+
allow = [
    "MIT",
    "Apache-2.0",
    "Apache-2.0 WITH LLVM-exception",
    "ISC",
    "Unicode-DFS-2016",
    "Unicode-3.0",
    "BSL-1.0",
    "BSD-2-Clause",
    "BSD-3-Clause",
    "MPL-2.0",
    "Zlib",
    "CC0-1.0",
    "OpenSSL",
    "CDLA-Permissive-2.0",
]

[bans]
# F-05: Duplicate dependency versions expand the binary attack surface.
# Security-critical parsing/crypto crates are denied from having multiple versions.
# Other crates that unavoidably accumulate versions are explicitly skipped below.
multiple-versions = "warn"
wildcards = "allow"
deny = []

# Skip lists for unavoidable transitive duplicates (tracked; reduce over time):
# x509-parser: pulled in at 0.16 by direct dep, newer versions by other transitive crates.
# Update Cargo.toml direct dep when upstreams converge on a single version.
skip = [
    { name = "x509-parser", reason = "F-13: three transitive versions (0.16/0.17/0.18); direct dep is 0.16; upstream update tracked" },
    { name = "asn1-rs", reason = "transitive of x509-parser multi-version chain" },
    { name = "rand", reason = "0.8 and 0.9 pulled by separate dependency subtrees; upstream migration ongoing" },
    { name = "getrandom", reason = "multiple versions due to rand/crypto crate ecosystem transition" },
    { name = "webpki-roots", reason = "0.26 and 1.x pulled by separate crates; update pending upstream" },
    { name = "brotli", reason = "7.x and 8.x due to async-compression version pinning" },
]

[sources]
unknown-registry = "warn"
unknown-git = "warn"
allow-registry = ["https://github.com/rust-lang/crates.io-index"]
